<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css"/>
        <script src="http://dimplejs.org/dist/dimple.v2.3.0.min.js"></script>
        <link href="https://fonts.googleapis.com/css2?family=Aclonica&family=Six+Caps&display=swap" rel="stylesheet">
        <script src="//d3js.org/d3.v3.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">
        <link rel="stylesheet" href="style.css">
    </head>
    

<body>
    <div class="hero-image">
        <div class="hero-text">
            <header>Titanic: Sink or Swim?</header>
        </div>
    </div>
    <nav>
        <ul>
            <li>
                <a class="backtitle" href="index.html" top:30px>
                <i class="fas fa-user-circle"></i> Go Back</a>
            </li>
        </ul>
    </nav>

</section>
<section id="zoom">

    <div class="bigbox2">
        <h1>Zoom Chart</h1>
        <div class="filters">
            <label for="gender">Filter by gender:</label>
            <select name="gender" id="gender">
                <option></option>
                <option value="female">Female</option>
                <option value="male">Male</option>
            </select>
        
            <label for="age">Filter by age:</label>
        
            <select name="age" id="age">
                <option></option>
                <option value="Over 30">Over 30</option>
                <option value="30 and under">30 and under</option>
            </select>
        
            <label for="survived">Filter by survival:</label>
        
            <select name="survived" id="survived">
                <option></option>
                <option value="yes">Survived</option>
                <option value="no">Did not survive</option>
            </select>
            <div class="image-test">
                <button>Reset</button>
            </div>
            <div class="zoomcircles"> </div>
<!--             <div class="tooltip">
                <span class="tooltiptext"></span>
            </div> -->
    </div>

<script>

     d3.csv("titanic passenger list (2).csv", data => {

        //console.log("DATA: ", data)
        createSymbolChart(data)

        
        let agetype = document.querySelector("#age")

        
         d3.select('#gender')
             .on("change", function (d) {
                let gendertype = document.querySelector("#gender").value
                console.log("gender: ", gendertype)
                 var newdata = data.filter(function(d){
                     //console.log("d in filter: ", d)
                     if (d.sex.toLowerCase()==gendertype){
                         return d;
                     } else if (gendertype==""){
                         return d;
                     }
                 })
                 //console.log("DATA NEW: ", newdata)
                 createSymbolChart(newdata);  
             });

        d3.select('#survived')
             .on("change", function (d) {
                 let survivaltype = document.querySelector("#survived").value
                 if (survivaltype == "Survived"){
                     var newdata = data.filter(function(d){
                         if (d.survived > 0){
                             return d;
                         } else if (survivaltype == "") {
                             return d;
                         }
                     }) 
                 } else { 
                    var newdata = data.filter(function (d) {
                         if (d.survived < 1) {
                             return d;
                         } else if (survivaltype == "") {
                             return d;
                         }
                     }) 
                 }
                 createSymbolChart(newdata);
             });

        d3.select('#age')
             .on("change", function (d) {
                 let agegroup = document.querySelector("#age").value
                 
                 var newdata = data.filter(function (d) {
                     //console.log("d in filter: ", d)
                     if (d.age_category == agegroup) {
                         return d;
                     } else if (agegroup == "") {
                         return d;
                     }
                 })
                 createSymbolChart(newdata);
             });





         d3.select("#sort-btn")
             .on("click", function (d) {
                 sorted += 1;
                 update(data, type, sorted)
             })
        var selected = d3.selectAll("#selected")
        .append("text")
        .text("oooo")
        .attr("fill", "white")



        console.log("selected: ", selected)

        })// end of csv call



function createSymbolChart(data) {

    d3.selectAll("circle")
    .transition()
    .duration(1000)
    .remove()

    d3.selectAll("text")
        .remove()

    d3.select("svg")
    .remove()

            var height = 600;
            var width = 1000;
            var scale = 1.0;

            var zoom = d3.behavior.zoom()
                .scale(scale)
                .scaleExtent([1, 5])
                // .on("zoom", zoomed);

            var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height)
                .call(zoom);
            

            var container = svg.append("g")
                .attr("id", "container")
                .attr("transform", "translate(0,0)scale(1,1)");

            var bbox, viewBox, vx, vy, vw, vh, defaultView;

            var clickScale = 33.0;		// scale used when circle is clicked
            d3.select("button").on("click", reset);

            // circle = container.append("g")
            //     .attr("id", "circles")
            //     .selectAll("circle")
            //     .data(circles)
            
        

            var dots = container.append("g")
                .attr("id", "circles")
                .selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", function (d, i) {

                    if (i < 50) {
                        return (i + 1) * 18;
                    }
                    else if (i < 100) {
                        return (i - 50 + 1) * 18;
                    }
                    else if (i < 150) {
                        return (i - 100 + 1) * 18;
                    }
                    else if (i < 200) {
                        return (i - 150 + 1) * 18;
                    }
                    else if (i < 250) {
                        return (i - 200 + 1) * 18;
                    }
                    else if (i < 300) {
                        return (i - 250 + 1) * 18;
                    }
                    else if (i < 350) {
                        return (i - 300 + 1) * 18;
                    }
                    else if (i < 400) {
                        return (i - 350 + 1) * 18;
                    }
                    else if (i < 450) {
                        return (i - 400 + 1) * 18;
                    }
                    else if (i < 500) {
                        return (i - 450 + 1) * 18;
                    }
                    else if (i < 550) {
                        return (i - 500 + 1) * 18;
                    }
                    else if (i < 600) {
                        return (i - 550 + 1) * 18;
                    }
                    else if (i < 650) {
                        return (i - 600 + 1) * 18;
                    }
                    else if (i < 700) {
                        return (i - 650 + 1) * 18;
                    }
                    else if (i < 750) {
                        return (i - 700 + 1) * 18;
                    }
                    else if (i < 800) {
                        return (i - 750 + 1) * 18;
                    }
                    else if (i < 850) {
                        return (i - 800 + 1) * 18;
                    }
                    else if (i < 900) {
                        return (i - 850 + 1) * 18;
                    }
                    else if (i < 950) {
                        return (i - 900 + 1) * 18;
                    }
                    else if (i < 1000) {
                        return (i - 950 + 1) * 18;
                    }
                    else if (i < 1050) {
                        return (i - 1000 + 1) * 18;
                    }
                    else if (i < 1100) {
                        return (i - 1050 + 1) * 18;
                    }
                    else if (i < 1150) {
                        return (i - 1100 + 1) * 18;
                    }
                    else if (i < 1200) {
                        return (i - 1150 + 1) * 18;
                    }
                    else if (i < 1250) {
                        return (i - 1200 + 1) * 18;
                    }
                    else if (i < 1300) {
                        return (i - 1250 + 1) * 18;
                    }
                    else {
                        return (i - 1300 + 1) * 18;
                    }

                })
                .attr("cy", function (d, i) {
                    //console.log("I: ", i)
                    if (i < 50) {
                        return 10;
                    }
                    else if (i < 100) {
                        return 30;
                    }
                    else if (i < 150) {
                        return 50
                    }
                    else if (i < 200) {
                        return 70
                    }
                    else if (i < 250) {
                        return 90
                    }
                    else if (i < 300) {
                        return 110
                    }
                    else if (i < 350) {
                        return 130
                    }
                    else if (i < 400) {
                        return 150
                    }
                    else if (i < 450) {
                        return 170
                    }
                    else if (i < 500) {
                        return 190
                    }
                    else if (i < 550) {
                        return 210
                    }
                    else if (i < 600) {
                        return 230
                    }
                    else if (i < 650) {
                        return 250
                    }
                    else if (i < 700) {
                        return 270
                    }
                    else if (i < 750) {
                        return 290
                    }
                    else if (i < 800) {
                        return 310
                    }
                    else if (i < 850) {
                        return 330
                    }
                    else if (i < 900) {
                        return 350
                    }
                    else if (i < 950) {
                        return 370
                    }
                    else if (i < 1000) {
                        return 390
                    }
                    else if (i < 1050) {
                        return 410
                    }
                    else if (i < 1100) {
                        return 430
                    }
                    else if (i < 1150) {
                        return 450
                    }
                    else if (i < 1200) {
                        return 470
                    }
                    else if (i < 1250) {
                        return 490
                    }
                    else if (i < 1300) {
                        return 510
                    }
                    else {
                        return 530
                    }
                })
                .attr("r", 8)
                .attr("fill", function (d) {
                    if (d.pclass == "1") {
                        return "gold"
                    }
                    else if (d.pclass == "2") {
                        return "lightblue"
                    }
                    else if (d.pclass == "3") {
                        return "pink"
                    }
                    else {
                        return "brown"
                    }
                })
                .on("click", clicked)
                .on("mouseover", function(d){
                    console.log("over: ", d)
                    d3.select()

                })

                var fnameLabels = container
                .selectAll(".fnameLabels")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "fnameLabels")
                .attr("x", function (d, i) {

                    if (i < 50) {
                        return (i + 1) * 18;
                    }
                    else if (i < 100) {
                        return (i - 50 + 1) * 18;
                    }
                    else if (i < 150) {
                        return (i - 100 + 1) * 18;
                    }
                    else if (i < 200) {
                        return (i - 150 + 1) * 18;
                    }
                    else if (i < 250) {
                        return (i - 200 + 1) * 18;
                    }
                    else if (i < 300) {
                        return (i - 250 + 1) * 18;
                    }
                    else if (i < 350) {
                        return (i - 300 + 1) * 18;
                    }
                    else if (i < 400) {
                        return (i - 350 + 1) * 18;
                    }
                    else if (i < 450) {
                        return (i - 400 + 1) * 18;
                    }
                    else if (i < 500) {
                        return (i - 450 + 1) * 18;
                    }
                    else if (i < 550) {
                        return (i - 500 + 1) * 18;
                    }
                    else if (i < 600) {
                        return (i - 550 + 1) * 18;
                    }
                    else if (i < 650) {
                        return (i - 600 + 1) * 18;
                    }
                    else if (i < 700) {
                        return (i - 650 + 1) * 18;
                    }
                    else if (i < 750) {
                        return (i - 700 + 1) * 18;
                    }
                    else if (i < 800) {
                        return (i - 750 + 1) * 18;
                    }
                    else if (i < 850) {
                        return (i - 800 + 1) * 18;
                    }
                    else if (i < 900) {
                        return (i - 850 + 1) * 18;
                    }
                    else if (i < 950) {
                        return (i - 900 + 1) * 18;
                    }
                    else if (i < 1000) {
                        return (i - 950 + 1) * 18;
                    }
                    else if (i < 1050) {
                        return (i - 1000 + 1) * 18;
                    }
                    else if (i < 1100) {
                        return (i - 1050 + 1) * 18;
                    }
                    else if (i < 1150) {
                        return (i - 1100 + 1) * 18;
                    }
                    else if (i < 1200) {
                        return (i - 1150 + 1) * 18;
                    }
                    else if (i < 1250) {
                        return (i - 1200 + 1) * 18;
                    }
                    else if (i < 1300) {
                        return (i - 1250 + 1) * 18;
                    }
                    else {
                        return (i - 1300 + 1) * 18;
                    }

                })
                .attr("y", function (d, i) {
                    //console.log("I: ", i)
                    if (i < 50) {
                        return 10-2;
                    }
                    else if (i < 100) {
                        return 30-2;
                    }
                    else if (i < 150) {
                        return 50-2;
                    }
                    else if (i < 200) {
                        return 70-2;
                    }
                    else if (i < 250) {
                        return 90-2;
                    }
                    else if (i < 300) {
                        return 110-2;
                    }
                    else if (i < 350) {
                        return 130-2;
                    }
                    else if (i < 400) {
                        return 150-2;
                    }
                    else if (i < 450) {
                        return 170-2;
                    }
                    else if (i < 500) {
                        return 190-2;
                    }
                    else if (i < 550) {
                        return 210-2;
                    }
                    else if (i < 600) {
                        return 230-2;
                    }
                    else if (i < 650) {
                        return 250-2;
                    }
                    else if (i < 700) {
                        return 270-2;
                    }
                    else if (i < 750) {
                        return 290-2;
                    }
                    else if (i < 800) {
                        return 310-2;
                    }
                    else if (i < 850) {
                        return 330-2;
                    }
                    else if (i < 900) {
                        return 350-2;
                    }
                    else if (i < 950) {
                        return 370-2;
                    }
                    else if (i < 1000) {
                        return 390-2;
                    }
                    else if (i < 1050) {
                        return 410-2;
                    }
                    else if (i < 1100) {
                        return 430-2;
                    }
                    else if (i < 1150) {
                        return 450-2;
                    }
                    else if (i < 1200) {
                        return 470-2;
                    }
                    else if (i < 1250) {
                        return 490-2;
                    }
                    else if (i < 1300) {
                        return 510-2;
                    }
                    else {
                        return 530-2;
                    }
                })
                .attr("text-anchor", "middle")
                .style("fill", "black")
                .style("font-size", "1px")
                .text(function(d){
                    return d.fname;
                })

                d3.selectAll(".fnameLabels").classed("hidden", true);


                var lnameLabels = container
                .selectAll(".lnameLabels")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "lnameLabels")
                .attr("x", function (d, i) {

                    if (i < 50) {
                        return (i + 1) * 18;
                    }
                    else if (i < 100) {
                        return (i - 50 + 1) * 18;
                    }
                    else if (i < 150) {
                        return (i - 100 + 1) * 18;
                    }
                    else if (i < 200) {
                        return (i - 150 + 1) * 18;
                    }
                    else if (i < 250) {
                        return (i - 200 + 1) * 18;
                    }
                    else if (i < 300) {
                        return (i - 250 + 1) * 18;
                    }
                    else if (i < 350) {
                        return (i - 300 + 1) * 18;
                    }
                    else if (i < 400) {
                        return (i - 350 + 1) * 18;
                    }
                    else if (i < 450) {
                        return (i - 400 + 1) * 18;
                    }
                    else if (i < 500) {
                        return (i - 450 + 1) * 18;
                    }
                    else if (i < 550) {
                        return (i - 500 + 1) * 18;
                    }
                    else if (i < 600) {
                        return (i - 550 + 1) * 18;
                    }
                    else if (i < 650) {
                        return (i - 600 + 1) * 18;
                    }
                    else if (i < 700) {
                        return (i - 650 + 1) * 18;
                    }
                    else if (i < 750) {
                        return (i - 700 + 1) * 18;
                    }
                    else if (i < 800) {
                        return (i - 750 + 1) * 18;
                    }
                    else if (i < 850) {
                        return (i - 800 + 1) * 18;
                    }
                    else if (i < 900) {
                        return (i - 850 + 1) * 18;
                    }
                    else if (i < 950) {
                        return (i - 900 + 1) * 18;
                    }
                    else if (i < 1000) {
                        return (i - 950 + 1) * 18;
                    }
                    else if (i < 1050) {
                        return (i - 1000 + 1) * 18;
                    }
                    else if (i < 1100) {
                        return (i - 1050 + 1) * 18;
                    }
                    else if (i < 1150) {
                        return (i - 1100 + 1) * 18;
                    }
                    else if (i < 1200) {
                        return (i - 1150 + 1) * 18;
                    }
                    else if (i < 1250) {
                        return (i - 1200 + 1) * 18;
                    }
                    else if (i < 1300) {
                        return (i - 1250 + 1) * 18;
                    }
                    else {
                        return (i - 1300 + 1) * 18;
                    }

                })
                .attr("y", function (d, i) {
                    //console.log("I: ", i)
                    if (i < 50) {
                        return 10-1;
                    }
                    else if (i < 100) {
                        return 30-1;
                    }
                    else if (i < 150) {
                        return 50-1;
                    }
                    else if (i < 200) {
                        return 70-1;
                    }
                    else if (i < 250) {
                        return 90-1;
                    }
                    else if (i < 300) {
                        return 110-1;
                    }
                    else if (i < 350) {
                        return 130-1;
                    }
                    else if (i < 400) {
                        return 150-1;
                    }
                    else if (i < 450) {
                        return 170-1;
                    }
                    else if (i < 500) {
                        return 190-1;
                    }
                    else if (i < 550) {
                        return 210-1;
                    }
                    else if (i < 600) {
                        return 230-1;
                    }
                    else if (i < 650) {
                        return 250-1;
                    }
                    else if (i < 700) {
                        return 270-1;
                    }
                    else if (i < 750) {
                        return 290-1;
                    }
                    else if (i < 800) {
                        return 310-1;
                    }
                    else if (i < 850) {
                        return 330-1;
                    }
                    else if (i < 900) {
                        return 350-1;
                    }
                    else if (i < 950) {
                        return 370-1;
                    }
                    else if (i < 1000) {
                        return 390-1;
                    }
                    else if (i < 1050) {
                        return 410-1;
                    }
                    else if (i < 1100) {
                        return 430-1;
                    }
                    else if (i < 1150) {
                        return 450-1;
                    }
                    else if (i < 1200) {
                        return 470-1;
                    }
                    else if (i < 1250) {
                        return 490-1;
                    }
                    else if (i < 1300) {
                        return 510-1;
                    }
                    else {
                        return 530-1;
                    }
                })
                .attr("text-anchor", "middle")
                .style("fill", "black")
                .style("font-size", "1px")
                .text(function(d){
                    return d.lname;
                })

                d3.selectAll(".lnameLabels").classed("hidden", true);

                var ageLabels = container
                .selectAll(".ageLabels")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "ageLabels")
                .attr("x", function (d, i) {

                    if (i < 50) {
                        return (i + 1) * 18;
                    }
                    else if (i < 100) {
                        return (i - 50 + 1) * 18;
                    }
                    else if (i < 150) {
                        return (i - 100 + 1) * 18;
                    }
                    else if (i < 200) {
                        return (i - 150 + 1) * 18;
                    }
                    else if (i < 250) {
                        return (i - 200 + 1) * 18;
                    }
                    else if (i < 300) {
                        return (i - 250 + 1) * 18;
                    }
                    else if (i < 350) {
                        return (i - 300 + 1) * 18;
                    }
                    else if (i < 400) {
                        return (i - 350 + 1) * 18;
                    }
                    else if (i < 450) {
                        return (i - 400 + 1) * 18;
                    }
                    else if (i < 500) {
                        return (i - 450 + 1) * 18;
                    }
                    else if (i < 550) {
                        return (i - 500 + 1) * 18;
                    }
                    else if (i < 600) {
                        return (i - 550 + 1) * 18;
                    }
                    else if (i < 650) {
                        return (i - 600 + 1) * 18;
                    }
                    else if (i < 700) {
                        return (i - 650 + 1) * 18;
                    }
                    else if (i < 750) {
                        return (i - 700 + 1) * 18;
                    }
                    else if (i < 800) {
                        return (i - 750 + 1) * 18;
                    }
                    else if (i < 850) {
                        return (i - 800 + 1) * 18;
                    }
                    else if (i < 900) {
                        return (i - 850 + 1) * 18;
                    }
                    else if (i < 950) {
                        return (i - 900 + 1) * 18;
                    }
                    else if (i < 1000) {
                        return (i - 950 + 1) * 18;
                    }
                    else if (i < 1050) {
                        return (i - 1000 + 1) * 18;
                    }
                    else if (i < 1100) {
                        return (i - 1050 + 1) * 18;
                    }
                    else if (i < 1150) {
                        return (i - 1100 + 1) * 18;
                    }
                    else if (i < 1200) {
                        return (i - 1150 + 1) * 18;
                    }
                    else if (i < 1250) {
                        return (i - 1200 + 1) * 18;
                    }
                    else if (i < 1300) {
                        return (i - 1250 + 1) * 18;
                    }
                    else {
                        return (i - 1300 + 1) * 18;
                    }

                })
                .attr("y", function (d, i) {
                    //console.log("I: ", i)
                    if (i < 50) {
                        return 10+1;
                    }
                    else if (i < 100) {
                        return 30+1;
                    }
                    else if (i < 150) {
                        return 50+1
                    }
                    else if (i < 200) {
                        return 70+1
                    }
                    else if (i < 250) {
                        return 90+1
                    }
                    else if (i < 300) {
                        return 110+1
                    }
                    else if (i < 350) {
                        return 130+1
                    }
                    else if (i < 400) {
                        return 150+1
                    }
                    else if (i < 450) {
                        return 170+1
                    }
                    else if (i < 500) {
                        return 190+1
                    }
                    else if (i < 550) {
                        return 210+1
                    }
                    else if (i < 600) {
                        return 230+1
                    }
                    else if (i < 650) {
                        return 250+1
                    }
                    else if (i < 700) {
                        return 270+1
                    }
                    else if (i < 750) {
                        return 290+1
                    }
                    else if (i < 800) {
                        return 310+1
                    }
                    else if (i < 850) {
                        return 330+1
                    }
                    else if (i < 900) {
                        return 350+1
                    }
                    else if (i < 950) {
                        return 370+1
                    }
                    else if (i < 1000) {
                        return 390+1
                    }
                    else if (i < 1050) {
                        return 410+1
                    }
                    else if (i < 1100) {
                        return 430+1
                    }
                    else if (i < 1150) {
                        return 450+1
                    }
                    else if (i < 1200) {
                        return 470+1
                    }
                    else if (i < 1250) {
                        return 490+1
                    }
                    else if (i < 1300) {
                        return 510+1
                    }
                    else {
                        return 530+1
                    }
                })
                .attr("text-anchor", "middle")
                .style("fill", "black")
                .style("font-size", "1px")
                .text(function(d){
                    return "Age: " + d.age_readable;
                })

                d3.selectAll(".ageLabels").classed("hidden", true);
                
                var familyText = container
                .selectAll(".familyText")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "familyText")
                .attr("x", function (d, i) {

                    if (i < 50) {
                        return (i + 1) * 18;
                    }
                    else if (i < 100) {
                        return (i - 50 + 1) * 18;
                    }
                    else if (i < 150) {
                        return (i - 100 + 1) * 18;
                    }
                    else if (i < 200) {
                        return (i - 150 + 1) * 18;
                    }
                    else if (i < 250) {
                        return (i - 200 + 1) * 18;
                    }
                    else if (i < 300) {
                        return (i - 250 + 1) * 18;
                    }
                    else if (i < 350) {
                        return (i - 300 + 1) * 18;
                    }
                    else if (i < 400) {
                        return (i - 350 + 1) * 18;
                    }
                    else if (i < 450) {
                        return (i - 400 + 1) * 18;
                    }
                    else if (i < 500) {
                        return (i - 450 + 1) * 18;
                    }
                    else if (i < 550) {
                        return (i - 500 + 1) * 18;
                    }
                    else if (i < 600) {
                        return (i - 550 + 1) * 18;
                    }
                    else if (i < 650) {
                        return (i - 600 + 1) * 18;
                    }
                    else if (i < 700) {
                        return (i - 650 + 1) * 18;
                    }
                    else if (i < 750) {
                        return (i - 700 + 1) * 18;
                    }
                    else if (i < 800) {
                        return (i - 750 + 1) * 18;
                    }
                    else if (i < 850) {
                        return (i - 800 + 1) * 18;
                    }
                    else if (i < 900) {
                        return (i - 850 + 1) * 18;
                    }
                    else if (i < 950) {
                        return (i - 900 + 1) * 18;
                    }
                    else if (i < 1000) {
                        return (i - 950 + 1) * 18;
                    }
                    else if (i < 1050) {
                        return (i - 1000 + 1) * 18;
                    }
                    else if (i < 1100) {
                        return (i - 1050 + 1) * 18;
                    }
                    else if (i < 1150) {
                        return (i - 1100 + 1) * 18;
                    }
                    else if (i < 1200) {
                        return (i - 1150 + 1) * 18;
                    }
                    else if (i < 1250) {
                        return (i - 1200 + 1) * 18;
                    }
                    else if (i < 1300) {
                        return (i - 1250 + 1) * 18;
                    }
                    else {
                        return (i - 1300 + 1) * 18;
                    }

                })
                .attr("y", function (d, i) {
                    //console.log("I: ", i)
                    if (i < 50) {
                        return 10+3;
                    }
                    else if (i < 100) {
                        return 30+3;
                    }
                    else if (i < 150) {
                        return 50+3
                    }
                    else if (i < 200) {
                        return 70+3
                    }
                    else if (i < 250) {
                        return 90+3
                    }
                    else if (i < 300) {
                        return 110+3
                    }
                    else if (i < 350) {
                        return 130+3
                    }
                    else if (i < 400) {
                        return 150+3
                    }
                    else if (i < 450) {
                        return 170+3
                    }
                    else if (i < 500) {
                        return 190+3
                    }
                    else if (i < 550) {
                        return 210+3
                    }
                    else if (i < 600) {
                        return 230+3
                    }
                    else if (i < 650) {
                        return 250+3
                    }
                    else if (i < 700) {
                        return 270+3
                    }
                    else if (i < 750) {
                        return 290+3
                    }
                    else if (i < 800) {
                        return 310+3
                    }
                    else if (i < 850) {
                        return 330+3
                    }
                    else if (i < 900) {
                        return 350+3
                    }
                    else if (i < 950) {
                        return 370+3
                    }
                    else if (i < 1000) {
                        return 390+3
                    }
                    else if (i < 1050) {
                        return 410+3
                    }
                    else if (i < 1100) {
                        return 430+3
                    }
                    else if (i < 1150) {
                        return 450+3
                    }
                    else if (i < 1200) {
                        return 470+3
                    }
                    else if (i < 1250) {
                        return 490+3
                    }
                    else if (i < 1300) {
                        return 510+3
                    }
                    else {
                        return 530+3
                    }
                })
                .attr("text-anchor", "middle")
                .style("fill", "black")
                .style("font-size", "1px")
                .text(function(d){
                    return "Family Members";
                })

                d3.selectAll(".familyText").classed("hidden", true);

                var memberNums = container
                .selectAll(".memberNums")
                .data(data)
                .enter()
                .append("text")
                .attr("class", "memberNums")
                .attr("x", function (d, i) {

                    if (i < 50) {
                        return (i + 1) * 18;
                    }
                    else if (i < 100) {
                        return (i - 50 + 1) * 18;
                    }
                    else if (i < 150) {
                        return (i - 100 + 1) * 18;
                    }
                    else if (i < 200) {
                        return (i - 150 + 1) * 18;
                    }
                    else if (i < 250) {
                        return (i - 200 + 1) * 18;
                    }
                    else if (i < 300) {
                        return (i - 250 + 1) * 18;
                    }
                    else if (i < 350) {
                        return (i - 300 + 1) * 18;
                    }
                    else if (i < 400) {
                        return (i - 350 + 1) * 18;
                    }
                    else if (i < 450) {
                        return (i - 400 + 1) * 18;
                    }
                    else if (i < 500) {
                        return (i - 450 + 1) * 18;
                    }
                    else if (i < 550) {
                        return (i - 500 + 1) * 18;
                    }
                    else if (i < 600) {
                        return (i - 550 + 1) * 18;
                    }
                    else if (i < 650) {
                        return (i - 600 + 1) * 18;
                    }
                    else if (i < 700) {
                        return (i - 650 + 1) * 18;
                    }
                    else if (i < 750) {
                        return (i - 700 + 1) * 18;
                    }
                    else if (i < 800) {
                        return (i - 750 + 1) * 18;
                    }
                    else if (i < 850) {
                        return (i - 800 + 1) * 18;
                    }
                    else if (i < 900) {
                        return (i - 850 + 1) * 18;
                    }
                    else if (i < 950) {
                        return (i - 900 + 1) * 18;
                    }
                    else if (i < 1000) {
                        return (i - 950 + 1) * 18;
                    }
                    else if (i < 1050) {
                        return (i - 1000 + 1) * 18;
                    }
                    else if (i < 1100) {
                        return (i - 1050 + 1) * 18;
                    }
                    else if (i < 1150) {
                        return (i - 1100 + 1) * 18;
                    }
                    else if (i < 1200) {
                        return (i - 1150 + 1) * 18;
                    }
                    else if (i < 1250) {
                        return (i - 1200 + 1) * 18;
                    }
                    else if (i < 1300) {
                        return (i - 1250 + 1) * 18;
                    }
                    else {
                        return (i - 1300 + 1) * 18;
                    }

                })
                .attr("y", function (d, i) {
                    //console.log("I: ", i)
                    if (i < 50) {
                        return 10+4;
                    }
                    else if (i < 100) {
                        return 30+4;
                    }
                    else if (i < 150) {
                        return 50+4
                    }
                    else if (i < 200) {
                        return 70+4
                    }
                    else if (i < 250) {
                        return 90+4
                    }
                    else if (i < 300) {
                        return 110+4
                    }
                    else if (i < 350) {
                        return 130+4
                    }
                    else if (i < 400) {
                        return 150+4
                    }
                    else if (i < 450) {
                        return 170+4
                    }
                    else if (i < 500) {
                        return 190+4
                    }
                    else if (i < 550) {
                        return 210+4
                    }
                    else if (i < 600) {
                        return 230+4
                    }
                    else if (i < 650) {
                        return 250+4
                    }
                    else if (i < 700) {
                        return 270+4
                    }
                    else if (i < 750) {
                        return 290+4
                    }
                    else if (i < 800) {
                        return 310+4
                    }
                    else if (i < 850) {
                        return 330+4
                    }
                    else if (i < 900) {
                        return 350+4
                    }
                    else if (i < 950) {
                        return 370+4
                    }
                    else if (i < 1000) {
                        return 390+4
                    }
                    else if (i < 1050) {
                        return 410+4
                    }
                    else if (i < 1100) {
                        return 430+4
                    }
                    else if (i < 1150) {
                        return 450+4
                    }
                    else if (i < 1200) {
                        return 470+4
                    }
                    else if (i < 1250) {
                        return 490+4
                    }
                    else if (i < 1300) {
                        return 510+4
                    }
                    else {
                        return 530+4
                    }
                })
                .attr("text-anchor", "middle")
                .style("fill", "black")
                .style("font-size", "1px")
                .text(function(d){
                    return "Aboard: " + d.family_members;
                })     
                
                d3.selectAll(".memberNums").classed("hidden", true);

    function getTextBox(selection) {
        selection
            .each(function (d) {
                d.bbox = this
                    .getBBox();
            })
            ;
    }
    // zoom to show a bounding box, with optional additional padding as percentage of box size

    /*
    circleLabels = dots
        .selectAll("g")
        .data(data)
        .enter()
        .append("g")
        .attr("class", "circleLabel")
        .attr("transform", function (d) {
            
            return (
                "transform", "translate(" + 100 + "," + 100 + ")scale(" + 33.0 + ")"
            );
        })
    circleLabels
        .append("text")
        .attr("class", "countryName")
        .style("text-anchor", "middle")
        .attr("dx", 0)
        .attr("dy", 0)
        .text(function (d) {
            return d.properties.name;
        })
        .call(getTextBox);


        // add mouseover functionality to the label
        //   .on("mouseover", function(d, i) {
        //       d3.select(this).style("display", "block");
        //   })
        //   .on("mouseout", function(d, i) {
        //        d3.select(this).style("display", "none");
        //  })
        // // add an onlcick action to zoom into clicked country
        // .on("click", function (d, i) {
        //     d3.selectAll(".country").classed("country-on", false);
        //     d3.select("#country" + d.properties.iso_a3).classed("country-on", true);
        //     boxZoom(path.bounds(d), path.centroid(d), 20);
        // });
            
        dots.append("text")
        .text(function (d) {
            //console.log("appending text", d)
            return d.pclass
        })
        .attr("x", function (d, i) {
            10 * i;
        })
        .attr("y", function (d, i) {
            10 * i;
        })
        .attr("fill", "white")
        */        

    bbox = container.node().getBBox();
    vx = bbox.x;		// container x co-ordinate
    vy = bbox.y;		// container y co-ordinate
    vw = bbox.width;	// container width
    vh = bbox.height;	// container height
    defaultView = "" + vx + " " + vy + " " + vw + " " + vh;
    svg
        .attr("viewBox", defaultView)
        .attr("preserveAspectRatio", "xMidYMid meet")
        .call(zoom);
            
            function getTransform(node, xScale) {
                bbox = node.node().getBBox();
                var bx = bbox.x;
                var by = bbox.y;
                var bw = bbox.width;
                var bh = bbox.height;
                var tx = -bx * xScale + vx + vw / 2 - bw * xScale / 2;
                var ty = -by * xScale + vy + vh / 2 - bh * xScale / 2;
                return { translate: [tx, ty], scale: xScale }
            }

            function clicked(d, i) {
                

                // if (d3.event.defaultPrevented) {
                //     return; // panning, not clicking
                // }
                
                d3.selectAll(".fnameLabels").classed("hidden", false);
                d3.selectAll(".lnameLabels").classed("hidden", false);
                d3.selectAll(".ageLabels").classed("hidden", false);
                d3.selectAll(".familyText").classed("hidden", false);
                d3.selectAll(".memberNums").classed("hidden", false);



                node = d3.select(this);
                console.log("node0: ", node[0][0])
                console.log(node)
                var circle = node[0][0]
                d3.select(circle)
                    .attr("id", "selected")
                d3.selectAll("#selected")
                    .append("text")
                    .text("YAY!")
                    .attr("font-size", 40)
                    .attr("fill", "white")

                console.log("HERE: ", circle)
                // circle.attr("id", "selected")
                var transform = getTransform(node, clickScale);
                console.log(transform)
                container.transition().duration(1000)
                    .attr("transform", "translate(" + transform.translate + ")scale(" + transform.scale + ")");
                console.log("container: ", container)
                zoom.scale(transform.scale)
                    .translate(transform.translate);
                console.log("zoom: ", zoom)
                scale = transform.scale;
                
                console.log("D in clicked: ", d)

                d3.selectAll("#selected")
                    .append("text")
                    .attr("x", 100)
                    .attr("y", 100)
                    .text("YAY!")
                    .attr("font-size", 40)
                    .attr("fill", "white")
                // d3.selectAll(".selected")
                //     .append("text")
                //     .attr('x', 10)
                //     .attr('y', 10)
                    
                //     .text("Income")
                //     .sytle("font-size", 8)
            }


            function zoomed() {
                var translateX = d3.event.translate[0];
                var translateY = d3.event.translate[1];
                var xScale = d3.event.scale;
                container.attr("transform", "translate(" + translateX + "," + translateY + ")scale(" + xScale + ")");
            }

            function reset() {
                scale = 0.0;
                //console.log(data)
                createSymbolChart(data)
                //container.attr("transform", "translate(0,0)scale(1,1)");
                console.log(container)

                var transform = getTransform(container, clickScale)
                console.log(transform)

                console.log("here: ", transform.scale)
                container.transition().duration(1000)

                    .attr("transform", "translate(" + [0, 0] + ")scale(" + 1.0 + ")");
                console.log("container: ", container)

                zoom.scale(scale)
                    .translate([0, 0]);


            }

        }// end of create Symbol Chart






        </script>
        </html>

